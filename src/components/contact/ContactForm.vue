<template>
  <div>
    <div class="row">
      <p v-if="isName">
        <font color="red">ãŠåå‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font>
      </p>
      <div class="input-field col s6">
        <input
          placeholder
          id="first_name"
          type="text"
          class="validate"
          v-model="firstName"
        />
        <label for="first_name">First Name</label>
      </div>
      <div class="input-field col s6">
        <input id="last_name" type="text" class="validate" v-model="lastName" />
        <label for="last_name">Last Name</label>
      </div>
    </div>
    <div class="row">
      <p v-if="isEmptyEmail">
        <font color="red">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font>
      </p>
      <p v-if="isValidEmail">
        <font color="red">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒé•ã„ã¾ã™ã€‚</font>
      </p>
      <div class="input-field col s12">
        <input id="email" type="email" class="validate" v-model="email" />
        <label for="email">Email</label>
      </div>
    </div>
    <div class="row">
      <p v-if="isEmptyDescription">
        <font color="red">ãŠå•ã„åˆã‚ã›å†…å®¹ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font>
      </p>
      <div class="input-field col s12">
        <textarea
          id="textarea1"
          class="materialize-textarea"
          v-model="description"
        ></textarea>
        <label for="textarea2">Content Of Inquiry</label>
      </div>
    </div>
    <p>
      <label>
        <input type="checkbox" v-model="cheacked"/>
        <span>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«åŒæ„ã—ã¾ã™ã€‚</span>
      </label>
    </p>
    <div class="module--spacing--small"></div>
    <div class="privacy">
        <h4 class="privacy-ttl">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</h4>
        <div class="module--spacing--small"></div>
        <p>Watataku'sï¼ˆä»¥ä¸‹ã€ã€Œå½“ã‚µã‚¤ãƒˆã€ï¼‰ã§ã¯ã€å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦ä¸‹è¨˜ã®ã‚ˆã†ã«å®šã‚ã¾ã™ã€‚</p>
        <h5>ã€å€‹äººæƒ…å ±ã®å–å¾—ã€‘</h5>
        <p>
          å½“ã‚µã‚¤ãƒˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çš†æ§˜ã®å€‹äººæƒ…å ±ï¼ˆæ°åã€ä½æ‰€ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€é›»è©±ç•ªå·ãªã©å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ï¼‰ã‚’å–å¾—ã•ã›ã¦é ‚ãã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
        </p>
        <h5>ã€å€‹äººæƒ…å ±ã®åˆ©ç”¨ã€‘</h5>
        <p>
          å–å¾—ã—ãŸå€‹äººæƒ…å ±ã¯ã€ä¸‹è¨˜ã®ç›®çš„ã§åˆ©ç”¨ã„ãŸã—ã¾ã™ã€‚<br>
          <ul>
            <li>ãŠå®¢æ§˜ã‹ã‚‰ã®ãŠå•ã„åˆã‚ã›ã«å¯¾ã™ã‚‹å›ç­”é€ä»˜</li>
          </ul>
        </p>
        <h5>ã€å€‹äººæƒ…å ±ã®å®‰å…¨ç®¡ç†ã€‘</h5>
        <p>
          å½“ã‚µã‚¤ãƒˆã§ã¯å–å¾—ã—ãŸå€‹äººæƒ…å ±ã«ã¤ã„ã¦é©åˆ‡ãªç®¡ç†ã«åŠªã‚ã‚‹ã¨å…±ã«å€‹äººæƒ…å ±ã®æ¼æ´©ã€æ”¹ã–ã‚“ã€ä¸æ­£ãªä¾µå…¥ã®é˜²æ­¢ã«åŠªã‚ã¾ã™ã€‚
        </p>
        <h5>ã€ç¬¬ä¸‰è€…ã¸ã®é–‹ç¤ºãƒ»æä¾›ã®ç¦æ­¢ã€‘</h5>
        <p>
          å½“ã‚µã‚¤ãƒˆã§ã¯ãŠå®¢æ§˜ã‚ˆã‚ŠãŠé ã‹ã‚Šã—ãŸå€‹äººæƒ…å ±ã‚’é©åˆ‡ã«ç®¡ç†ã—ã€æ¬¡ã®ã„ãšã‚Œã‹ã«è©²å½“ã™ã‚‹å ´åˆã‚’é™¤ãã€å€‹äººæƒ…å ±ã‚’ç¬¬ä¸‰è€…ã«é–‹ç¤ºã„ãŸã—ã¾ã›ã‚“ã€‚<br>
          <ul>
            <li>æ³•å¾‹ä¸Šç…§ä¼šæ¨©é™ã‚’æœ‰ã™ã‚‹è€…ã‹ã‚‰æ›¸é¢ã«ã‚ˆã‚‹æ­£å¼ãªå”åŠ›è¦è«‹ã€ç…§ä¼šãŒã‚ã£ãŸå ´åˆ</li>
            <li>ãŠå®¢æ§˜ã®åŒæ„ãŒã‚ã£ãŸå ´åˆ</li>
          </ul>
        </p>
        <h5>ã€å€‹äººæƒ…å ±ã«é–¢ã™ã‚‹å•ã„åˆã‚ã›ã€‘</h5>
        <p>
          å€‹äººæƒ…å ±ã«é–¢ã™ã‚‹ãŠå•ã„åˆã‚ã›ã¯ã€ä¸‹è¨˜ã¾ã§ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚<br>
          Watataku<br>
          ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:watano.takuya@gmail.com
        </p>
        <h5>ã€æ”¹å¤‰ã¨è¦‹ç›´ã—ã«ã¤ã„ã¦ã€‘</h5>
        <p>å€‹äººæƒ…å ±ã«ã¤ã„ã¦ã¯ã€æ³•ä»¤å¤‰æ›´ãªã©ã‚’å—ã‘ã¦éšæ™‚è¦‹ç›´ã—ã‚’è¡Œã„ã¾ã™ã€‚</p>
    </div>
    <div class="module--spacing--small"></div>
    <div class="module--spacing--small"></div>
    <div class="module--spacing--small"></div>
    <button
      class="btn waves-effect waves-light"
      type="submit"
      name="action"
      :disabled="!cheacked"
      @click="submitForm"
      v-show="!isLoading"
    >
      é€ä¿¡
    </button>
    <div class="loading">
      <pulse-loader :loading="isLoading"></pulse-loader>
    </div>
  </div>
</template>

<script>
import PulseLoader from "vue-spinner/src/PulseLoader";
import {slackApiURL} from "../../seacretDirectory/seacret"

export default {
  components: {
    PulseLoader,
  },
  data() {
    return {
      firstName: "",
      lastName: "",
      email: "",
      description: "",
      cheacked: false,
      isLoading: false, //ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ•ãƒ©ã‚°

      // â‡©â‡©â‡©â‡©ã‚¨ãƒ©ãƒ¼ãƒ•ãƒ©ã‚°
      isName: false,
      isEmptyEmail: false,
      isValidEmail: false,
      isEmptyDescription: false,
    };
  },
  methods: {
    // fetchãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ•ã‚©ãƒ¼ãƒ ã®å†…å®¹ã‚’Slackã®Incoming Webhook URL ã«é€ä¿¡ã™ã‚‹
    goSlack() {
      this.isLoading = true;

      const payload = {
        text:
          "ãŠå•ã„åˆã‚ã›ãŒã‚ã‚Šã¾ã—ãŸ\n" +
          "ãŠåå‰: " +
          this.firstName +
          " " +
          this.lastName +
          "\n" +
          "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: " +
          this.email +
          "\n" +
          "ã€å•ã„åˆã‚ã›å†…å®¹ã€‘\n" +
          this.description,
      };

      const WEBHOOK_URL = slackApiURL();
      fetch(WEBHOOK_URL, {
        method: "POST",
        body: JSON.stringify(payload),
      }).then(() => {
        alert("é€ä¿¡ãŒå®Œäº†ã—ã¾ã—ãŸã€‚è¿½ã£ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ğŸ™Œ");
        this.firstName = "";
        this.lastName = "";
        this.email = "";
        this.description = "";
        this.isLoading = false;
        this.cheacked = false;
      });
    },

    //ãƒ¡ã‚¢ãƒ‰å½¢å¼ãƒã‚§ãƒƒã‚¯
    validateEmailFormat(email) {
      const regex = /^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/;
      return regex.test(email);
    },

    // clickã‚¤ãƒ™ãƒ³ãƒˆ
    submitForm() {
      let flg = false;

      //name error
      if (this.firstName.length == 0) {
        flg = true;
        this.isName = true;
      } else {
        this.isName = false;
      }
      if (this.lastName.length == 0) {
        flg = true;
        this.isName = true;
      } else {
        this.isName = false;
      }

      //email error
      if (this.email.length == 0) {
        flg = true;
        this.isEmptyEmail = true;
        this.isValidEmail = false;
      } else if (!this.validateEmailFormat(this.email)) {
        flg = true;
        this.isEmptyEmail = false;
        this.isValidEmail = true;
      } else {
        this.isEmptyEmail = false;
        this.isValidEmail = false;
      }

      //description error
      if (this.description.length == 0) {
        flg = true;
        this.isEmptyDescription = true;
      } else {
        this.isEmptyDescription = false;
      }

      if (!flg) {
        //Slacké€ä¿¡å‡¦ç†
        this.goSlack();
      }
    },
  },
};
</script>

<style scoped>
input {
  margin-top: 20px !important;
}
textarea {
  margin-top: 20px !important;
}
.materialize-textarea {
  height: 180px !important;
}
.module--spacing--small {
  height: 10px;
}
.privacy li {
  list-style: square inside;
}
button {
  width: 30%;
}
/*PC*/
@media screen and (min-width: 1026px) {
  .privacy {
    margin: 0 auto;
    padding: 1%;
    width: 50%;
    height: 200px;
    border: 1px solid #000;
    overflow: scroll;
  }
  .privacy-ttl {
    margin-top: 0px;
    font-size: 17px;
  }

  .privacy h5 {
    font-size: 15px;
    text-align: left;
  }

  .privacy p {
    font-size: 10px;
    text-align: left;
  }
}
/*ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ*/
@media screen and (min-width: 482px) and (max-width: 1025px) {
  .privacy {
    margin: 0 auto;
    padding: 1.5%;
    width: 95%;
    height: 250px;
    border: 1px solid #000;
    overflow: scroll;
  }

  .privacy-ttl {
    margin-top: 0px;
    font-size: 17px;
  }

  .privacy h5 {
    font-size: 15px;
    text-align: left;
  }

  .privacy p {
    font-size: 10px;
    text-align: left;
  }
}
@media screen and (max-width: 481px) {
  .privacy {
    margin: 0 auto;
    padding: 1%;
    width: 95%;
    height: 200px;
    border: 1px solid #000;
    overflow: scroll;
  }

  .privacy-ttl {
    font-size: 17px;
  }

  .privacy h5 {
    font-size: 15px;
    text-align: left;
  }

  .privacy p {
    font-size: 10px;
    text-align: left;
  }
}
</style>
